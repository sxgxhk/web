title: Centos7上搭建Lnmp+Ghost 1.x博客
categories: 网站建设
tags: [Ghost]
date: 2017-11-03 05:15:00
---
<p>上次写过<a href="https://blog.uu126.cn/debian-8-8da-jian-lnmp-ghost-1-x-jiao-cheng/">《Debian 8.X搭建Lnmp+ Ghost 1.x 教程》</a> ，这不将主机从香港搬回到大杭州后，域名又倒腾回之前的uu126.cn（当然加了个前缀blog），加上前不久刚好在<a href="http://blog.imzhengfei.com/centos-7-an-zhuang-pei-zhi-ghost-1-x/">海月博客</a> ，顺手也尝试了一下Centos，结果一切搭建顺利，又可以让我啰嗦一下了。</p><ol><li>Lnmp的搭建就不细说了，可以参照我之前的博文（点击：<a href="https://blog.uu126.cn/debian-8-8da-jian-lnmp-ghost-1-x-jiao-cheng/">传送门</a> ），这里还是推荐使用Oneinstack，相对功能多一点。搭建好以后，使用PHPmyadmin创建所需的博客数据库用户名、数据库（用这个创建较方便），另外也可以直接配置好站点的Nginx文件和SSL，这里就不在啰嗦了，有问题的亲，可以留言。</li><li><p>安装 Node.js</p><ul><li>方法一：</li></ul></li></ol><pre><code>curl -sL https://deb.nodesource.com/setup_6.x | bash -
apt-get install nodejs</code></pre><ul><li>方法二（推荐使用）：</li></ul><pre><code>国外下载地址：
wget https://nodejs.org/download/release/v6.9.5/node-v6.9.5.tar.gz
国内下载地址：
wget https://npm.taobao.org/mirrors/node/v6.9.5/node-v6.9.5.tar.gz
tar zxvf node-v6.9.5.tar.gz
cd node-v6.9.5
./configure
make &amp;&amp; make install</code></pre><p>安装好之后可以使用<code> node -v </code>查看，能看到版本号一般就OK了。</p><ol><li>配置 Yarn<br />  可选，使用 yarn 代替 npm，更加快速，安全，稳定。</li></ol><pre><code>wget https://dl.yarnpkg.com/rpm/yarn.repo -O /etc/yum.repos.d/yarn.repo
yum -y install yarn</code></pre><p>同样安装之后可以使用<code> yarn -v </code>查看，看到版本号就行。</p><ul><li>查看 npm 全局生成可执行文件软链的路径：</li></ul><pre><code>npm -g bin</code></pre><blockquote><p>/usr/bin</p></blockquote><ul><li>查看 yarn 全局生成可执行文件软链的路径：</li></ul><pre><code>yarn global bin</code></pre><blockquote><p>/usr/local/bin</p></blockquote><p>修改 yarn 全局生成可执行文件软链的路径和 npm 保持一致：</p><pre><code>yarn config set prefix /usr</code></pre><blockquote><p>yarn config v1.2.1<br />success Set "prefix" to "/usr".<br />Done in 0.03s.</p></blockquote><p>再次查看 yarn 全局生成可执行文件软链的路径：</p><pre><code>yarn global bin</code></pre><blockquote><p>/usr/bin</p></blockquote><ol><li>安装 Ghost-CLI<br />使用 yarn 全局安装 ghost-cli：</li></ol><pre><code>yarn global add ghost-cli</code></pre><p>查看安装的 ghost-cli 版本：</p><pre><code>ghost -v</code></pre><blockquote><p>Ghost-CLI version: 1.1.3</p></blockquote><ol><li>安装Ghost1.X<br />创建网站目录：</li></ol><pre><code>mkdir -p /home/wwwroot/blog.uu126.cn</code></pre><p>进入到网站目录：</p><pre><code>cd /home/wwwroot/blog.uu126.cn</code></pre><p>在当前目录免配置安装 ghost：</p><pre><code>ghost install --no-setup</code></pre><blockquote><p>✔ Checking system Node.js version<br />✔ Checking current folder permissions<br />System checks failed with message: 'Linux version is not Ubuntu 16'<br />Some features of Ghost-CLI may not work without additional configuration.<br />For local installs we recommend using ghost install local instead.<br />? Continue anyway?</p></blockquote><p>输入<code> y </code>，回车：</p><blockquote><p>? Continue anyway? Yes<br />✔ Checking operating system<br />✔ Checking MySQL is installed<br />✔ Checking for latest Ghost version<br />✔ Setting up install directory<br />✔ Downloading and installing Ghost v1.16.0<br />✔ Finishing install process</p></blockquote><ol><li><p>配置Ghost1.x</p><ul><li>使用 ghost-ci 配置 ghost：</li></ul></li></ol><pre><code>ghost config</code></pre><blockquote><p>? Enter your blog URL: (<a href="http://localhost">http://localhost</a>:2368)</p></blockquote><p>输入自己网站完整访问路径<code> http://blog.uu126.cn </code>回车：</p><blockquote><p>? Enter your blog URL: <a href="http://blog.imzhengfei.com">http://blog.imzhengfei.com</a><br />? Enter your MySQL hostname: (localhost)</p></blockquote><p>输入 MySQL 主机地址，如果在本机直接回车：</p><blockquote><p>? Enter your MySQL hostname: localhost<br />? Enter your MySQL username:</p></blockquote><p>输入上面创建的 MySQL 用户名，密码，数据库名称：</p><blockquote><p>? Enter your MySQL username: ghost<br />? Enter your MySQL password: [hidden]<br />? Enter your Ghost database name: ghost</p></blockquote><ul><li>初始化数据库</li></ul><p>使用 ghost-ci 初始化数据库：</p><pre><code>ghost setup migrate</code></pre><blockquote><p>✔ Running database migrations</p></blockquote><ul><li>配置系统用户</li></ul><p>使用 ghost-ci 添加 ghost 用户来运行 ghost：</p><pre><code>ghost setup linux-user</code></pre><blockquote><p>Running sudo command: useradd --system --user-group ghost<br />Running sudo command: chown -R ghost:ghost /home/wwwroot/blog.imzhengfei.com/content<br />✔ Setting up "ghost" system user</p></blockquote><ul><li>配置系统服务</li></ul><p>使用 ghost-ci 创建系统服务：</p><pre><code>ghost setup systemd</code></pre><blockquote><p>Running sudo command: ln -sf &gt;/home/wwwroot/blog.uu126.cn/system/files/ghost_undefined.service &gt;/lib/systemd/system/ghost_undefined.service<br />Running sudo command: systemctl daemon-reload<br />✔ Setting up Systemd</p></blockquote><ol><li><p>测试访问博客</p><ul><li>使用 ghost-ci 启动当前网站：</li></ul></li></ol><pre><code>ghost start</code></pre><blockquote><p>✔ Validating config<br />Running sudo command: systemctl start ghost_undefined<br />✔ Starting Ghost<br />Running sudo command: systemctl enable ghost_undefined --quiet<br />✔ Starting Ghost<br />You can access your blog at <a href="http://blog.uu126.cn">http://blog.uu126.cn</a><br />Ghost uses direct mail by default<br />To set up an alternative email method read our docs at <a href="https://docs.ghost.org/docs/mail-config">https://docs.ghost.org/docs/mail-config</a></p></blockquote><ul><li>尝试访问自己的博客。</li></ul><p>注册管理员账户<strong>（ domain 是自己的博客域名）</strong>：</p><pre><code>http:///ghost</code></pre>